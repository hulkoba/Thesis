\chapter{\label{chap:grundlagen}Grundlagen}
Was bedeutet offlinefähig?\\
\note{Harte, weiche, mittlere probleme (verschiedene Stufen von offlinefähig)}\\
Native \Glspl{App} existieren und funktionieren grundsätzlich solange offline, bis sie versuchen online Daten abzurufen.\\
bei nativen Apps ist das Problem bei der Datenverteilung
%
% Offline-First
%
\section{Offline First}
%
% Anforderungen
%
% \sub{Anforderungen an Offline-First Anwendungen}
% Eine Webanwendung besteht grundsätzlich aus zwei Bestandteilen: \it{\gls{Assets}} und benutzerInnengenerierte Daten.\\
% Um offline nutzbar zu sein, müssen einige Voraussetzungen erfüllt werden.
% \begin{itemize}
%   \item müssen auf dem Endgerät gespeichert werden
%   \item Serverseitige (nicht lokal) Datenbank \&\& Synchronisation zwischen Server ind Client
%   \item Kollaborativ \&\& Sync zwischen allen Beteiligten
%   \item Synchronisation erfordert den Umgang mit Konflikten
%   \item Kein Datenverlust
% \end{itemize}
% \todo{merge mit PWA?}
Offline First heißt, die Bestandteile einer Anwendung so zu verwalten, dass nach der ersten Verwendung keine Internetverbindung mehr notwendig ist um deren grundlegenden Funktionen zu nutzen.\todo{Quelle}\\
Eine Anwendung, die für den Offline-Gebrauch entwickelt wurde, ist sowohl mit, als auch ohne Internetverbindung vollständig einsatzbereit. Bei einer bestehenden Internetverbindung ist das Laden der Ressourcen aus dem Cache schneller als aus dem Netz. Daten, die zuerst lokal gespeichert werden, gehen auch bei plötzlichen Verbindungsverlust nicht verloren.
%
% Cache ServiceWorker AppCache
%
\input{chapters/2/cache}
%
% Browser
%
\input{chapters/2/browser}
%
% Sync
%
\sub{Datenbanksynchronisation}
%
% Couch
%
\subsub{\label{sec:couch}CouchDB}
Apache CouchDB\tm ist ein \gls{DBMS} das seit 2005 als freie Software entwickelt wird. Die dokumentenorientierte \gls{DB} funktioniert sowohl als einzelne Instanz, als auch im Cluster, in dem ein Datenbanksserver auf einer beliebig großen Anzahl an Servern oder \glspl{VM} ausgeführt werden kann. So kann die Datenschicht beliebig skaliert werden, um die Anforderungen vieler BenutzerInnen zu erfüllen. CouchDB verwendet das \gls{HTTP}--Protokoll und \gls{JSON} als Datenformat, weswegen es mit jeder Webfähigen Anwendung kompatibel ist. CouchDB wird über ein \gls{REST}ful \gls{HTTP} \gls{API} angesprochen. Mit den für \gls{REST}ful Services standardisierten Methoden z. B. GET, POST, PUT, DELETE können die Daten abgerufen und. manipuliert werden.\\
Das implementierte Replikationsmodell erlaubt die Synchronisation bzw. bidirektionale Replikation zu verschiedenen Geräten ist genau die Besonderheit, die CouchDB als eine Offline--Datenbank auszeichnet. Dessen Funktionsweise wird in \autoref{sec:replication} detailliert beschrieben. Dieses Protokoll ist die Grundlage für Offline First Anwendungen.
Das Replikations-API von CouchDB bietet die Möglichkeit, eine Datenbank kontinuierlich oder selbstgesteuert mit einer anderen zu synchronisieren.
So kann beispielsweise eine CouchDB-Instanz auf dem Mobiltelefon und eine auf dem Laptop bestehen und beide können sich bei bestehender Internetverbindung synchronisieren. Da so die gespeicherten Daten aus dem lokalen Speicher gelesen werden, sind ein schnelles Interface und eine geringe Latenz die positive Folge. Wenn Konflikte auftreten, beispielsweise durch gleichzeitiges Bearbeiten eines Dokuments von zwei Personen ohne Netzwerkverbindung, werden diese als solche markiert, jedoch nicht von selbst aufgelöst. So gehen keine Daten verloren und es liegt an der benutzenden Person diese zu lösen. \todo{Referenz git?}\\
CouchDB ist für Server konzipiert. Für Browser gibt es \hyperref[sub:pouch]{PouchDB} und für native iOS- und Android--\glspl{App} wurde Couchbase Lite entwickelt. Alle können Daten miteinander replizieren und verwenden das CouchDB Replikationsprotokoll~\cite{couch}.
\todo{CouchDB Replikationsmodell hier?}
%
% Pouch
%
\subsub{\label{sub:pouch}PouchDB}
\todo{Was benutzt Poch wann? -- IndexedDB, Web SQL, LevelDB}
Als Ergänzung zu CouchDB kann PouchDB verwendet werden. PouchDB ist eine Open--Source--JavaScript--Datenbank, die so konzipiert wurde, dass sie im Browser läuft. PouchDB ermöglicht es Anwendungen zu erstellen, die sowohl offline als auch online funktionieren. Daten können lokal gespeichert werden, sodass alle Funktionen der Anwendung auch im Offline--Modus zur Verfügung stehen.
Daten werden unabhängig von der nächsten Anmeldung (des nächsten Onlinezugangs) zwischen \b{Clients}, CouchDB oder kompatiblen Servern synchronisiert.
PouchDB läuft auch in Node.js\footnote{JavaScript Laufzeitumgebung, steht unter \url{https://nodejs.org/en/download/} zum Download bereit} und kann als direkte Schnittstelle zu CouchDB--kompatiblen Servern verwendet werden~\cite{pouch}.

%
% PWA
%
\sub{\label{sub:pwa}Progressive Web Apps \todo{raus?}}
\Gls{PWA} ist eine Bezeichnung für eine mobil nutzbare Webseite, die eine Brücke zwischen der nativen
Applikation und einer Webseite schlägt.
Der Begriff \gls{PWA} wurde im Jahr 2015  von Alex Russel und seiner Frau Frances Berriman geprägt.
Dieser beschreibt Webseiten, die die positiven Funktionen von nativen Applikationen mitbringen, aber statt über App Stores installiert zu werden, im Webbrowser existieren. Die Webseiteninhalte sind ohne die Installation sofort und jederzeit für die NutzerInnen abrufbar. Schon beim zweiten Besuch der Webseite ist die Ladezeit der Daten verkürzt und sie ist offline, oder auch bei schlechter Internetverbindung nutzbar. Nach mehrmaligem Aufruf kann die \gls{PWA} über den Browser installiert und zum Startbildschirm hinzugefügt werden. Russel und Berriman legen folgende Einenschaften einer \gls{PWA} fest:
\begin{description}[leftmargin=0.5cm,style=nextline]
	\item[Responsive] to fit any form factor
	\item[Connectivity independent] Progressively-enhanced with Service Workers to let them work offline
	\item[App-like-interactions] Adopt a Shell + Content application model to create appy navigations \& interactions
	\item[Fresh] Transparently always up-to-date thanks to the Service Worker update process
	\item[Safe] Served via TLS (a Service Worker requirement) to prevent snooping
	\item[Discoverable] Are identifiable as “applications” thanks to W3C Manifests and Service Worker registration scope a llowing search engines to find them
	\item[Re-engageable] Can access the re-engagement UIs of the OS; e.g. Push Notifications
	\item[Installable] to the home screen through browser-provided prompts, allowing users to “keep” apps they find most useful without the hassle of an app store
	\item[Linkable] meaning they’re zero-friction, zero-install, and easy to share. The social power of URLs matters.
\end{description}
\todo{Näher erläutern?}~\cite{pwa}.

%
% Konflikte [Jan]
%
\input{chapters/2/conflicts}