\chapter{\label{chap:grundlagen}Grundlagen}
Was bedeutet offlinefähig?\\
\note{Harte, weiche, mittlere probleme (verschiedene Stufen von offlinefähig)}\\
Native \Glspl{App} existieren und funktionieren grundsätzlich solange offline, bis sie versuchen online Daten abzurufen.\\
bei nativen Apps ist das Problem bei der Datenverteilung
%
% Offline-First
%
\section{Offline First}
Offline First heißt, die Bestandteile einer Anwendung so zu verwalten, dass nach der ersten Verwendung keine Internetverbindung mehr notwendig ist um deren grundlegenden Funktionen zu nutzen.\todo{Quelle}\\
Eine Anwendung, die für den Offline-Gebrauch entwickelt wurde, ist sowohl mit, als auch ohne Internetverbindung vollständig einsatzbereit. Bei einer bestehenden Internetverbindung ist das Laden der Ressourcen aus dem Cache schneller als aus dem Netz. Daten, die zuerst lokal gespeichert werden, gehen auch bei plötzlichen Verbindungsverlust nicht verloren.
Für Anwendungen mit einer serverseitigen Datenbank ist die Synchronisation der Daten zwischen Server und Client notwendig. Die Synchronisation von Datenbanken ist ein sehr komplexer Vorgang und erfordert zusätzlich die Fähigkeit mit Konflikten umzugehen. Außerdem dürfen auf keinen Fall Daten verloren gehen. Im diesem Abschnitt werden einige Technologien, die sich dieser Problematik widmen vorgestellt.
%
% Cache ServiceWorker AppCache
%
\input{chapters/2/cache}
%
%
%
\sub{Lokale Speicherung im Browser}
Der zweite Schritt Daten offline verfügbar zu machen ist sie im Browser zu speichern. Einige Konzepte hierfür werden im Folgenden erläutert.
%
\subsub{Web Storage}
Das Web Storage \gls{API} ist ein Web-Standard mit dessen Hilfe Daten als Schlüssel / Wert Paare im Browser gespeichert werden können. Es wird, wie Abbildung \ref{fig:webStorage} zeigt, von allen relevanten Browsern unterstützt.
Web Storage umfasst zwei Mechanismen. Den Session Storage und den Local Storage.\\
Der Session Storage existiert nur so lange der Browser geöffnet ist.
Das heißt alle Daten die im Session Storage gespeichert werden, existieren nicht mehr sobald der Browser geschlossen wird. Daten die im Local Storage gespeichert sind, existieren dort solange bis der Browser Cache geleert wird~\cite{webstorage}.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{webStorage}
	\grayRule
	\caption{Browserkompatibilität für Web Storage, Quelle: ~\cite{caniuse-ws}}
	\label{fig:webStorage}
\end{figure}
Der von den Browsern freigegebene Cache-Space für Web Storage variiert, ist aber meist auf 10 MB begrenzt. Der größte Nachteil ist wohl, dass Web Storage synchron arbeitet und so andere Operationen, wie zum Beispiel das Rendern der Seite, blockieren kann~\cite{webstorage-con}.
%
%
\subsub{WebSQL}
%
%
\subsub{IndexedDB}
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{indexedDB}
	\grayRule
	\caption{Browserkompatibilität für IndexedDB, Quelle: ~\cite{caniuse-idb}}
	\label{fig:indexedDB}
\end{figure}
%
\subsub{IndexedDB 2}
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{indexedDB2}
	\grayRule
	\caption{Browserkompatibilität für IndexedDB 2.0, Quelle: ~\cite{caniuse-idb}}
	\label{fig:indexedDB2}
\end{figure}
https://www.w3.org/TR/IndexedDB-2/
%
% Anforderungen
%
% \sub{Anforderungen an Offline-First Anwendungen}
% Eine Webanwendung besteht grundsätzlich aus zwei Bestandteilen: \it{\gls{Assets}} und benutzerInnengenerierte Daten.\\
% Um offline nutzbar zu sein, müssen einige Voraussetzungen erfüllt werden.
% \begin{itemize}
%   \item müssen auf dem Endgerät gespeichert werden
%   \item Serverseitige (nicht lokal) Datenbank \&\& Synchronisation zwischen Server ind Client
%   \item Kollaborativ \&\& Sync zwischen allen Beteiligten
%   \item Synchronisation erfordert den Umgang mit Konflikten
%   \item Kein Datenverlust
% \end{itemize}
% \todo{merge mit PWA?}
%
% PWA
%
\sub{\label{sub:pwa}Progressive Web Apps}
\Gls{PWA} ist eine Bezeichnung für eine mobil nutzbare Webseite, die eine Brücke zwischen der nativen
Applikation und einer Webseite schlägt.
Der Begriff \gls{PWA} wurde im Jahr 2015  von Alex Russel und seiner Frau Frances Berriman geprägt.
Dieser beschreibt Webseiten, die die positiven Funktionen von nativen Applikationen mitbringen, aber statt über App Stores installiert zu werden, im Webbrowser existieren. Die Webseiteninhalte sind ohne die Installation sofort und jederzeit für die NutzerInnen abrufbar. Schon beim zweiten Besuch der Webseite ist die Ladezeit der Daten verkürzt und sie ist offline, oder auch bei schlechter Internetverbindung nutzbar. Nach mehrmaligem Aufruf kann die \gls{PWA} über den Browser installiert und zum Startbildschirm hinzugefügt werden. Russel und Berriman legen folgende Einenschaften einer \gls{PWA} fest:
\begin{description}[leftmargin=0.5cm,style=nextline]
	\item[Responsive] to fit any form factor
	\item[Connectivity independent] Progressively-enhanced with Service Workers to let them work offline
	\item[App-like-interactions] Adopt a Shell + Content application model to create appy navigations \& interactions
	\item[Fresh] Transparently always up-to-date thanks to the Service Worker update process
	\item[Safe] Served via TLS (a Service Worker requirement) to prevent snooping
	\item[Discoverable] Are identifiable as “applications” thanks to W3C Manifests and Service Worker registration scope a llowing search engines to find them
	\item[Re-engageable] Can access the re-engagement UIs of the OS; e.g. Push Notifications
	\item[Installable] to the home screen through browser-provided prompts, allowing users to “keep” apps they find most useful without the hassle of an app store
	\item[Linkable] meaning they’re zero-friction, zero-install, and easy to share. The social power of URLs matters.
\end{description}
\todo{Näher erläutern?}~\cite{pwa}.
%
% Konflikte [Jan]
%
\input{chapters/2/conflicts}